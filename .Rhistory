year(medianHousePrice.df$DATE[1])
?year
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML')
loadLibraries(requiredPackages)
year(medianHousePrice.df$DATE[1])
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate')
loadLibraries(requiredPackages)
rm(requiredPackages)
rm(zillowComps.df)
rm(zillowComps.keep.df)
rm(zillowUpdates.keep.df)
mydb <- dbConnect(RSQLite::SQLite(),"my-db.sqlite")
zillowComps.df <- dbGetQuery(mydb, "Select * From zillowDeepComps")
View(zillowComps.df)
View(medianHousePrice.df)
getYearAvgFromMonthly <- function(in.df,year) {
in.df <- in.df[year(in.df$DATE)==year]
}
getYearAvgFromMonthly(medianHousePrice.df,"2013")
getYearAvgFromMonthly <- function(in.df,year) {
in.df <- in.df[year(in.df$DATE)==year,]
}
getYearAvgFromMonthly(medianHousePrice.df,"2013")
test <- getYearAvgFromMonthly(medianHousePrice.df,"2013")
View(test)
?summarise
getYearAvgFromMonthly <- function(in.df,year) {
in.df <- in.df[year(in.df$DATE)==year,]
out <- in.df %>% group_by(year(DATE)) %>% summarise(mean = mean(MSPNHSUS))
}
test <- getYearAvgFromMonthly(medianHousePrice.df,"2013")
View(test)
getYearAvgFromMonthly <- function(in.df,year) {
in.df <- in.df[year(in.df$DATE)==year,]
out <- in.df %>% group_by(year(DATE)) %>% summarise(mean = mean(MSPNHSUS))
return(out$mean)
}
test <- getYearAvgFromMonthly(medianHousePrice.df,"2013")
getYearAvgFromMonthly <- function(in.df,year) {
in.df <- in.df[year(in.df$DATE)==year,]
out <- in.df %>% group_by(year(DATE)) %>% summarise(mean = trunc(mean(MSPNHSUS)))
return(out$mean)
}
test <- getYearAvgFromMonthly(medianHousePrice.df,"2013")
zillowMerged.df$lastSoldDate <- as.Date(zillowMerged.df$lastSoldDate)
zillowComps.keep.df <- zillowComps.df %>% select(zpid,
taxAssessmentYear,
taxAssessment,
lastSoldDate,
`last-updated`,
percentile,
zindexValue)
zillowUpdates.keep.df <- zillowUpdates %>% select(zpid,
street,
zipcode,
city,
state,
numRooms,
bedrooms,
bathrooms,
finishedSqFt,
lotSizeSqFt,
yearBuilt,
coveredParkingSpaces,
roof,
exteriorMaterial,
heatingSources,
heatingSystem,
coolingSystem,
floorCovering,
architecture,
numFloors,
basement,
parkingType,
coveredParkingSpaces)
zillowMerged.df <- left_join(zillowUpdates.keep.df,zillowComps.keep.df,by="zpid")
zillowMerged.df$lastSoldDate <- mdy(zillowMerged.df$lastSoldDate)
zillowMerged.df$`last-updated` <- mdy(zillowMerged.df$`last-updated`)
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(DATE) == year(in.date)]
}
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date)]
}
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
}
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
test <- getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
View(test)
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
}
View(test)
test <- getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
View(test)
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
return(in.df$MSPNHSUS)
}
test <- getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgAssessYear = getYearAvgFromMonthly(medianHousePrice.df,taxAssessmentYear),
natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$taxAssessmentYear)==FALSE]
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$taxAssessmentYear)==FALSE]
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$taxAssessmentYear)==FALSE,]
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgAssessYear = getYearAvgFromMonthly(medianHousePrice.df,taxAssessmentYear),
natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$lastSoldDate)==FALSE]
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$lastSoldDate)==FALSE,]
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgAssessYear = getYearAvgFromMonthly(medianHousePrice.df,taxAssessmentYear),
natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgAssessYear = getYearAvgFromMonthly(medianHousePrice.df,taxAssessmentYear))
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[1])
getMedianFromDate(medianHousePrice.df,zillowMerged.df$lastSoldDate[100])
zillowMerged.df <- ungroup(zillowMerged.df)
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
out <- in.df$MSPNHSUS
if(is.NA(out)) {out<-NULL}
return(out)
}
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
out <- in.df$MSPNHSUS
if(is.na(out)) {out<-NULL}
return(out)
}
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
out <- in.df$MSPNHSUS
if(is.na(out)) {out<-0}
return(out)
}
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
out <- in.df$MSPNHSUS
return(out)
}
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
getMedianFromDate <- function(in.df,in.date){
in.df <- in.df[year(in.df$DATE) == year(in.date),]
in.df <- in.df[month(in.df$DATE) == month(in.date),]
out <- in.df$MSPNHSUS
if(length(out) == 0) { out <- 0 }
return(out)
}
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
zillowMerged.df <- zillowMerged.df[zillowMerged.df$natAvgLastSoldYear != 0]
zillowMerged.df <- zillowMerged.df[zillowMerged.df$natAvgLastSoldYear != 0,]
View(zillowComps.df)
View(zillowSearch.df)
?GetDeepComps
test <- GetDeepComps(zpid = "73519249")
test <- GetDeepComps(zpid = "73519249",1)
test <- GetDeepSearchResults(zpid = "73519249",zws_id = get_zillow_web_service_id())
test <- GetDeepSearchResults(address = 10622 Hillcross Ct, citystatezip = "40229",zws_id = get_zillow_web_service_id())
test <- GetDeepSearchResults(address = "10622 Hillcross Ct", citystatezip = "40229",zws_id = get_zillow_web_service_id())
View(zillowMerged.df)
zillow.model <- lm(taxAssessment ~ natAvgAssessYear, data=zillowMerged.df)
summary(zillow.model)
confint(zillow.model)
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'coorplot')
loadLibraries(requiredPackages)
loadLibraries(requiredPackages)
install.packages('corrplot')
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot')
loadLibraries(requiredPackages)
rm(requiredPackages)
zillow.cor <- cor(zillowMerged.df)
corrplot(zillow.cor)
zillow.cor <- cor(zillowMerged.df)
zillow.cor <- cor(select(zillowMerged.df,6:11,12,20,23:30))
zillow.cor <- cor(select(zillowMerged.df,6:11,23:30))
str(zillowMerged.df)
zillowMerged.int.df <- zillowMerged.df
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.numeric(zillowMerged.int.df[,i])
}
View(zillowMerged.int.df)
str(zillowMerged.int.df)
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- sapply(zillowMerged.int.df[,i], as.numeric)
}
str(zillowMerged.int.df)
zillowMerged.int.df <- zillowMerged.df
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.numeric(as.character(zillowMerged.int.df[,i]))
}
zillowMerged.int.df <- zillowMerged.df
str(zillowMerged.int.df)
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
zillowMerged.int.df <- zillowMerged.df
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
str(zillowMerged.int.df)
zillowMerged.int.df <- zillowMerged.df
?grep
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot',
'stringr')
loadLibraries(requiredPackages)
rm(requiredPackages)
str_replace("111,123",",","")
zillowMerged.df$zindexValue <- sapply(zillowMerged.int.df, function(x) {str_replace(x,",","")})
zillowMerged.df$zindexValue <- sapply(zillowMerged.int.df, function(x) {str_replace(x,",","")})
zillowMerged.df$zindexValue <- sapply(zillowMerged.int.df$zindexValue, function(x) {str_replace(x,",","")})
zillowMerged.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
zillowComps.keep.df <- zillowComps.df %>% select(zpid,
taxAssessmentYear,
taxAssessment,
lastSoldDate,
`last-updated`,
percentile,
zindexValue)
zillowUpdates.keep.df <- zillowUpdates %>% select(zpid,
street,
zipcode,
city,
state,
numRooms,
bedrooms,
bathrooms,
finishedSqFt,
lotSizeSqFt,
yearBuilt,
coveredParkingSpaces,
roof,
exteriorMaterial,
heatingSources,
heatingSystem,
coolingSystem,
floorCovering,
architecture,
numFloors,
basement,
parkingType,
coveredParkingSpaces)
zillowMerged.df <- left_join(zillowUpdates.keep.df,zillowComps.keep.df,by="zpid")
rm(zillowComps.keep.df)
rm(zillowUpdates.keep.df)
zillowMerged.df$lastSoldDate <- mdy(zillowMerged.df$lastSoldDate)
zillowMerged.df$`last-updated` <- mdy(zillowMerged.df$`last-updated`)
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$taxAssessmentYear)==FALSE,]
zillowMerged.df <- zillowMerged.df[is.na(zillowMerged.df$lastSoldDate)==FALSE,]
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgAssessYear = getYearAvgFromMonthly(medianHousePrice.df,taxAssessmentYear))
zillowMerged.df <- ungroup(zillowMerged.df)
zillowMerged.df <- zillowMerged.df %>% rowwise() %>% mutate(natAvgLastSoldYear = getMedianFromDate(medianHousePrice.df,lastSoldDate))
zillowMerged.df <- zillowMerged.df[zillowMerged.df$natAvgLastSoldYear != 0,]
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
str(zillowMerged.int.df)
zillow.cor <- cor(select(zillowMerged.df,6:11,23:30))
?is.na
zillowMerged.int.df <- na.omit(zillowMerged.int.df)
zillow.cor <- cor(select(zillowMerged.df,6:11,23:30))
for(i in c(6:11)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillowMerged.int.df <- na.omit(zillowMerged.int.df)
zillow.cor <- cor(select(zillowMerged.df,6:11,23:30))
for(i in c(6:10)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillowMerged.int.df <- na.omit(zillowMerged.int.df)
zillow.cor <- cor(select(zillowMerged.df,6:11))
zillow.cor <- cor(select(zillowMerged.df,6:8))
zillow.cor <- cor(select(zillowMerged.df,7:8))
select(zillowMerged.int.df,7:8)
zillow.cor <- cor(select(zillowMerged.int.df,6:11,23:30))
corrplot(zillow.cor)
?scatterplot
??scatterplot
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot',
'stringr',
'car')
loadLibraries(requiredPackages)
loadLibraries(requiredPackages)
?delay
?Sys.sleep
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot',
'stringr',
'car')
loadLibraries(requiredPackages)
rm(requiredPackages)
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillow.cor <- cor(select(zillowMerged.int.df,6:11,23:30))
corrplot(zillow.cor)
zillowMerged.int.df <- na.omit(zillowMerged.int.df)
zillow.cor <- cor(select(zillowMerged.int.df,6:11,23:30))
corrplot(zillow.cor)
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillowMerged.int.df <- na.omit(zillowMerged.int.df)
zillow.cor <- cor(na.omit(select(zillowMerged.int.df,6:11,23:30)))
corrplot(zillow.cor)
scatterplot(zillowMerged.int.df$lotSizeSqFt, zillowMerged.int.df$taxAssessment)
zillow.model <- lm(zindexValue ~ natAvgAssessYear, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
corrplot(zillow.cor)
zillow.model <- lm(zindexValue ~ finishedSqFt, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
corrplot(zillow.cor)
zillow.model <- lm(zindexValue ~ finishedSqFt + numRooms + bedrooms + bathrooms + lotSizeSqFt, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
?rcorr
influenceIndexPlot(zillow.model)
vif(zillow.model)
?stepAIC
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot',
'stringr',
'car',
'MASS')
loadLibraries(requiredPackages)
rm(requiredPackages)
fowardAIC <- stepAIC(zillow.model,direction="foward",trace=FALSE)
fowardAIC <- stepAIC(zillow.model,direction="forward",trace=FALSE)
summary(forwardAIC)
forwardAIC <- stepAIC(zillow.model,direction="forward",trace=FALSE)
summary(forwardAIC)
rm(fowardAIC)
AIC <- stepAIC(zillow.model,direction="backward",trace=FALSE)
summary(AIC)
AIC$anova
rm(forwardAIC)
remove.packages('MASS')
requiredPackages <- c('ZillowR',
'readr',
'tidyverse',
'RSQLite',
'DBI',
'XML',
'lubridate',
'corrplot',
'stringr',
'car',
'olsrr')
loadLibraries(requiredPackages)
loadLibraries(requiredPackages)
rm(requiredPackages)
AIC <- ols_stepaic_forward(zillow.model)
summary(AIC)
AIC$anova
AIC
AIC <- ols_stepaic_backward(zillow.model)
summary(AIC)
AIC
AIC <- ols_stepaic_backward(zillow.model,details=TRUE)
summary(AIC)
AIC
zillowMerged.int.df <- zillowMerged.df
zillowMerged.int.df$zindexValue <- str_replace(zillowMerged.int.df$zindexValue,",","")
for(i in c(6:11,23:30)) {
zillowMerged.int.df[,i] <- as.data.frame(lapply(zillowMerged.int.df[,i],as.numeric),stringsAsFactors = FALSE)
}
zillow.cor <- cor(na.omit(select(zillowMerged.int.df,6:11,23:30)))
zillow.cor <- cor(na.omit(select(zillowMerged.int.df)),6:11,23:30)
corrplot(zillow.cor)
scatterplot(zillowMerged.int.df$lotSizeSqFt, zillowMerged.int.df$taxAssessment)
zillow.model <- lm(zindexValue ~ finishedSqFt + numRooms + bedrooms + bathrooms + lotSizeSqFt, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
AIC <- ols_stepaic_backward(zillow.model,details=TRUE)
AIC
AIC <- ols_stepaic_foward(zillow.model,details=TRUE)
AIC <- ols_stepaic_forward(zillow.model,details=TRUE)
AIC
?lm
zillow.model <- lm(zindexValue ~ finishedSqFt + numRooms + bedrooms + bathrooms + lotSizeSqFt + zipcode, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
AIC <- ols_stepaic_forward(zillow.model,details=TRUE)
AIC
influenceIndexPlot(zillow.model)
residualPlot(zillow.model)
zillow.model <- lm(zindexValue ~ finishedSqFt + numRooms + bedrooms + bathrooms + lotSizeSqFt + zipcode + taxAssessment, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
summary(zillow.model)
AIC <- ols_stepaic_forward(zillow.model,details=TRUE)
AIC
zillow.model <- lm(zindexValue ~ finishedSqFt + numRooms + bedrooms + bathrooms + lotSizeSqFt + zipcode + parkingType + basement + exteriorMaterial + taxAssessment, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
AIC <- ols_stepaic_forward(zillow.model,details=TRUE)
AIC
residualPlot(zillow.model)
zillow.model <- lm(zindexValue ~ bedrooms + bathrooms + lotSizeSqFt + zipcode + parkingType + basement + exteriorMaterial, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
zillow.model <- lm(zindexValue ~ bedrooms + bathrooms + lotSizeSqFt + zipcode + parkingType, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
zillow.model <- lm(zindexValue ~ bedrooms + bathrooms + lotSizeSqFt + zipcode, data=zillowMerged.int.df)
summary(zillow.model)
confint(zillow.model)
residualPlot(zillow.model)
influenceIndexPlot(zillow.model)
vif(zillow.model)
summary(zillow.model)
